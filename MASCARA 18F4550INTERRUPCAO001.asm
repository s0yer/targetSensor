#include <p18F4550.inc>
	
RADIX DEC

	CONFIG WDT=OFF
	CONFIG MCLRE = ON
	CONFIG DEBUG = ON
	CONFIG LVP = OFF
	CONFIG FOSC = HS
	

#DEFINE BOTAO1	PORTE,0			; SW0 -> INCREMENTA
#DEFINE BOTAO2	PORTE,1			; SW1 -> ZERA
#DEFINE BOTAO3	PORTE,2			; SW2 -> DECREMENTA
#DEFINE BOTAO4	PORTB,3			; SW2 -> SWAP NYBBLES




	CBLOCK 0x20	; Bloco contendo as variáveis

	ENDC


	
ORG 0x000	; Vetor de reset
GOTO START


;HI
ORG 0x0008
   CALL INTERRUPCAOHI

RETFIE

;LOW
ORG 0x0018
   CALL INTERRUPCAOLOW
  
RETFIE

ORG 0X04
BTFSS PORTB,4
GOTO DESV1
INCF CONTR0
DESV1

BTFSS PORTB,5
GOTO DESV2
INCF CONTR1
DESV2

BTFSS PORTB,4
GOTO DESV3
INCF CONTR2
DESV3

BTFSS PORTB,7
GOTO DESV4
INCF CONTR3
DESV4

RETFIE





START
   CALL CONFIGURARPORTA
   CALL CONFIGURARINTERRUPCAO


; PROGRAMA PRINCIPAL
MAIN

;CODE WRITE
MOVLW .0
MOVWF CONTR0
MOVWF CONTR1
MOVWF CONTR2
MOVWF CONTR3

COMECO
    BSF PORTD,7
    NOP
    BCF PORTD,7
    NOP
GOTO COMECO





CONFIGURARPORTA

	CLRF PORTA
	MOVLW B'11001001'
	MOVWF TRISA

	CLRF PORTB
	MOVLW B'11110001' ; OK
	MOVWF TRISB

	CLRF PORTC
	MOVLW B'00000000' ; OK
	MOVWF TRISC

	CLRF PORTD
	MOVLW B'00000000'
	MOVWF TRISD

	CLRF PORTE
	MOVLW B'00001111'
	MOVWF TRISE

RETURN

CONFIGURARINTERRUPCAO

    MOVF PORTB
    
	; Desliga comparador analógico
	MOVLW B'00001111'	
	MOVWF CMCON

	; Configura todos pinos como entrada digital
	MOVLW B'00000000'
	MOVWF ADCON0

	; Configura todos pinos como entrada digital
	MOVLW B'00001111'
	MOVWF ADCON1

	; Configura interrupção REGISTRO RCON
    ; BIT7 =0 DESABILITA PRIORIDADE
	MOVLW B'00000000'
	MOVWF RCON

	; Configura interrupção REGISTRO INTCON
    ; BIT7 HABILITA TODAS AS INTERRUPÇÕES
    ; BIT6 HABILITA INTERRUPÇÃO PERIFERICOS
    ; BIT5 INTERRUPÇÃO TIMER0
    ; BIT4 INT0
    ; BIT3 INT RB
    ; BIT2 TIMER0 SETADO SE TIMER0 OVER
    ; BIT1 SETADO SE INTERRUPCAO RB0
    ; BIT0 SETADO SE INTERRUPCAO RB4 a RB7
	MOVLW B'11011000' ;OK
	MOVWF INTCON

	; Configura interrupção REGISTRO INTCON2
	MOVLW B'00000000'
    ; BIT6 =0 INT0 BORDA DE DESCIDA
    ; BIT2 TMR0 = 0 PRIORIDADE BAIXA
    ; BIT0 RB PRIORIDADE   =0  LOW
	MOVWF INTCON2

	; Configura interrupção REGISTRO INTCON3
	MOVLW B'00000000'
	MOVWF INTCON3

	; CONFIGURA INTERRUPÇÃO TMR0 REGISTRO T0CON
	MOVLW B'00000000'
    ; BIT7 = 1 HABILITA TIMER0
    ; BIT6 = 0 TIMER0 16 BITS
    ; BIT5 = 0 CLOCK INTERNO
    ; BIT4 = 0 BORDA DE SUBIDA
    ; BIT3 = 0 PRESCALER ATIVADOS
    ; BIT210 = 000 CLOCK/2
    ; BIT210 = 001 CLOCK/4
    ; BIT210 = 010 CLOCK/8
    ; BIT210 = 011 CLOCK/16
    ; BIT210 = 100 CLOCK/32
    ; BIT210 = 101 CLOCK/64
    ; BIT210 = 110 CLOCK/128
    ; BIT210 = 111 CLOCK/256
	MOVWF T0CON


RETURN 



INTERRUPCAOHI

RETURN


INTERRUPCAOLOW

RETURN


END

